---
class: 512
flags: 0x2000
unid: OF112E8ACFF57FE875-ON005D9E97852573C6
items:
  - name: $DBScript
    type: text
    data: |
      '++LotusScript Development Environment:2:5:(Options):0:74
      Option Declare
      '++LotusScript Development Environment:2:5:(Forward):0:1
      Declare Sub RemoveDocs(source As NotesUIDatabase,dc As notesDocumentcollection)
      Declare Sub Querydocumentdelete(Source As Notesuidatabase, Continue As Variant)
      
      '++LotusScript Development Environment:2:5:(Declarations):0:10
      '[Translation Begin]
      Const DocPreviewTitle = "Delete"
      Const DocPreviewMessage = |The document could not be deleted because you currently have the same document open in the Preview Pane.  
      This open document will be closed so it can be deleted from the current view.|
      '[Translation End]
      
      '++LotusScript Development Environment:2:2:BindEvents:1:129
      Private Sub BindEvents(Byval Objectname_ As String)
      	Static Source As NOTESUIDATABASE
      	Set Source = Bind(Objectname_)
      	On Event Querydocumentdelete From Source Call Querydocumentdelete
      End Sub
      
      '++LotusScript Development Environment:2:2:RemoveDocs:1:8
      Sub RemoveDocs(source As NotesUIDatabase,dc As notesDocumentcollection)
      	
      	On Error Goto Errorroutine
      	
      	Dim ws As New notesuiworkspace
      	Dim note As NotesDocument
      	Dim notePlaceHolder As NotesDocument
      	Dim noteid As String
      	
      	If Not(dc Is Nothing) Then
      		Set note = dc.GetFirstdocument
      	Else
      ' If collection document from view is nothing then probably a document is opened
      		Set note = ws.currentdocument.document
      		If Not(note Is Nothing) Then			
      			Set notePlaceHolder = note
      			If notePlaceHolder.IsUIDocOpen Then
      				noteid = notePlaceHolder.noteid
      				Delete notePlaceHolder			
      				Set notePlaceHolder = ws.CurrentDatabase.database.getdocumentbyid(noteid)
      				notePlaceHolder.remove(True)
      				Exit Sub
      			End If
      		End If
      	End If
      	
      'Documents selected in a view with or without Preview pane... 
      	While Not (note Is Nothing)
      		Set notePlaceHolder = note
      		Set note = dc.getnextdocument(note)
      		If notePlaceHolder.IsUIDocOpen Then
      			noteid = notePlaceHolder.noteid
      			Delete notePlaceHolder			
      			Set notePlaceHolder = ws.CurrentDatabase.database.getdocumentbyid(noteid)
      			notePlaceHolder.remove(True)
      			Call ws.viewrefresh
      		Else
      			notePlaceHolder.remove( True)
      			Call ws.viewrefresh
      		End If		
      	Wend	
      	
      	Exit Sub	
      	
      ErrorRoutine:
      	If Err = 4241 Then
      		Messagebox DocPreviewMessage, 48, DocPreviewTitle
      		Exit Sub
      	End If
      	
      	Exit Sub
      	
      End Sub
      '++LotusScript Development Environment:2:2:Querydocumentdelete:1:12
      Sub Querydocumentdelete(Source As Notesuidatabase, Continue As Variant)
      	On Error Goto ErrorTrap
      	
      	Dim ws As New notesuiworkspace
      	Dim uiview As NotesUIView
      	Dim uidoc As NotesUIDocument
      	Dim collection As NotesDocumentCollection
      	Dim doc As NotesDocument
      	
      	Dim strViewName As String
      	Dim e As Variant
      	Dim SoftDelEnabled As Integer
      	
      	Set uiview = ws.currentview
      	
      	If Not(uiview Is Nothing) Then
      		strViewName=uiview.ViewAlias
      		Set collection = source.documents
      	End If
      	
      	'is softdeletes enabled...
      	SoftDelEnabled = False
      	e =  Evaluate( "@IsSoftDeleteEnabled")
      	If Isarray(e) Then
      		If e(0) = 1 Then
      			SoftDelEnabled = True			
      		End If
      	End If	
      	
      	If SoftDelEnabled = True Then
      		Call RemoveDocs(source, collection)
      		continue = False
      		Call ws.ViewRefresh
      		Exit Sub
      	End If
      	
      ErrorTrap:
      	If Cstr(Err) <> "0" Then Print (Cstr(Err) & " " & Error$)
      	Exit Sub
      End Sub
    signed: true
    nonsummary: true
  - name: $DBScript_O
    type: text
    opaque: |
      AQAAAkxTT0IDABQIZW4AAAQANQCCAgQAEABECiAHAAAAAAAAnAHwBgAAAAAAAMAAGAA4ADQDtAJUAAAA
      AAAAAAUAAAAIAIgFAAAAACgAKAA4AjgCiAWIBQAAAAAAAAAACAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      SABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      AAAAAAcAAAD8APAGwAPwBgAAAACoAfACAAAAAIQEhAQAAAAAUAZQBgAAAAAAAAAAAAAAAPwA/AAAAAAA
      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      AAAAAAEABQBMb3R1cyBQcm9kdWN0AAAAVjAuMAAAAAAAAAAAAAAAAAAAAAAEAAAAggIAAAAAAABECgAA
      IAcAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAYAAABXMzJJIQMAAAAAAAAAAAAA
      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAkBwAAAAAkAAgAKgA2AEMAMQAzAEMA
      MQA0AAAAAABsAAMATgBFAFcAAACAAAYARABFAEwARQBUAEUAAAAAAKgACgBJAE4ASQBUAEkAQQBMAEkA
      WgBFAAAAAAD4AAkAVABFAFIATQBJAE4AQQBUAEUAAADQAgYATwBCAEoARQBDAFQAAAAAAIgAAAAAAAAA
      nAAGAFMATwBVAFIAQwBFAAAAAADkAAIARABDAAAAAACEAwgAQwBPAE4AVABJAE4AVQBFAAAAAACYAg8A
      RABPAEMAUABSAEUAVgBJAEUAVwBUAEkAVABMAEUAAAB0BAYARABlAGwAZQB0AGUAAAAAACABEQBEAE8A
      QwBQAFIARQBWAEkARQBXAE0ARQBTAFMAQQBHAEUAAAAIA7gAVABoAGUAIABkAG8AYwB1AG0AZQBuAHQA
      IABjAG8AdQBsAGQAIABuAG8AdAAgAGIAZQAgAGQAZQBsAGUAdABlAGQAIABiAGUAYwBhAHUAcwBlACAA
      eQBvAHUAIABjAHUAcgByAGUAbgB0AGwAeQAgAGgAYQB2AGUAIAB0AGgAZQAgAHMAYQBtAGUAIABkAG8A
      YwB1AG0AZQBuAHQAIABvAHAAZQBuACAAaQBuACAAdABoAGUAIABQAHIAZQB2AGkAZQB3ACAAUABhAG4A
      ZQAuACAAIAAKAFQAaABpAHMAIABvAHAAZQBuACAAZABvAGMAdQBtAGUAbgB0ACAAdwBpAGwAbAAgAGIA
      ZQAgAGMAbABvAHMAZQBkACAAcwBvACAAaQB0ACAAYwBhAG4AIABiAGUAIABkAGUAbABlAHQAZQBkACAA
      ZgByAG8AbQAgAHQAaABlACAAYwB1AHIAcgBlAG4AdAAgAHYAaQBlAHcALgAAAAAAuAMKAEIASQBOAEQA
      RQBWAEUATgBUAFMAAAAAAMQDCwBPAEIASgBFAEMAVABOAEEATQBFAF8AAAD0Ag8ATgBPAFQARQBTAFUA
      SQBEAEEAVABBAEIAQQBTAEUAAADIBgYAJQBMAFMAWABVAEkAAAAAAPwDEwBRAFUARQBSAFkARABPAEMA
      VQBNAEUATgBUAEQARQBMAEUAVABFAAAAUAMKAFIARQBNAE8AVgBFAEQATwBDAFMAAAAAANgEFwBOAE8A
      VABFAFMARABPAEMAVQBNAEUATgBUAEMATwBMAEwARQBDAFQASQBPAE4AAACYAwYAJQBMAFMAWABCAEUA
      AAAAAKgFDABFAFIAUgBPAFIAUgBPAFUAVABJAE4ARQAAAAAAVAUCAFcAUwAAAAAA7AMQAE4ATwBUAEUA
      UwBVAEkAVwBPAFIASwBTAFAAQQBDAEUAAAAAAGAEBABOAE8AVABFAAAAAAAcBA0ATgBPAFQARQBTAEQA
      TwBDAFUATQBFAE4AVAAAADwEDQBOAE8AVABFAFMARABBAFQAQQBCAEEAUwBFAAAAaAUPAE4ATwBUAEUA
      UABMAEEAQwBFAEgATwBMAEQARQBSAAAAnAQGAE4ATwBUAEUASQBEAAAAAAAwBRAARwBFAFQARgBJAFIA
      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
    signed: true
    nonsummary: true
  - name: $Flags
    type: text
    data: t34Q
  - name: $LANGUAGE
    type: text
    data: en
    signed: true
  - name: $PublicAccess
    type: text
    data: "1"
    signed: true
  - name: $Revisions
    type: time
    data: "2008-01-04T12:02:58.91-05:00"
  - name: $TITLE
    type: text
    data: Database Script
    signed: true
remaining: []